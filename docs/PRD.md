# 微爱 AI聊天应用 - 产品需求文档 (PRD)

> **版本**: 2.0
> **更新日期**: 2026-02-03
> **产品负责人**: WeLove Team

---

## 一、产品概述

### 1.1 产品愿景

微爱是一款新一代AI社交平台，通过智能AI角色为用户提供陪伴、娱乐和情感支持。我们致力于打造一个温暖、有趣、安全的虚拟社交空间，让每个人都能找到属于自己的AI伴侣。

### 1.2 产品定位

| 维度 | 描述 |
|------|------|
| **目标用户** | 18-35岁年轻用户，追求情感陪伴和娱乐体验 |
| **核心价值** | 智能对话 + 情感陪伴 + RPG沉浸体验 |
| **产品形态** | 跨平台应用（Web、iOS、Android、Flutter） |
| **商业模式** | Freemium + VIP订阅 + 虚拟礼物 |

### 1.3 核心竞争力

1. **拟人化AI角色** - 30+预设角色，每个角色有独特性格和故事背景
2. **好感度养成系统** - 6级好感度进阶，解锁专属内容
3. **RPG沉浸式体验** - 分支剧情脚本，用户选择影响故事走向
4. **多模态交互** - 文字、语音、图片全方位互动
5. **社交朋友圈** - AI角色也会发布动态，增强真实感

---

## 二、功能架构

### 2.1 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      微爱 AI聊天应用                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │   聊天模块   │  │   角色模块   │  │   社交模块   │          │
│  │  Chat       │  │  Character  │  │  Social     │          │
│  └─────────────┘  └─────────────┘  └─────────────┘          │
│                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │   钱包模块   │  │   商城模块   │  │   用户模块   │          │
│  │  Wallet     │  │  Shop       │  │  User       │          │
│  └─────────────┘  └─────────────┘  └─────────────┘          │
│                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │   管理后台   │  │   语音合成   │  │   数据分析   │          │
│  │  Admin      │  │  TTS        │  │  Analytics  │          │
│  └─────────────┘  └─────────────┘  └─────────────┘          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 功能模块清单

| 模块 | 功能 | 优先级 | 状态 |
|------|------|--------|------|
| **聊天系统** | 文字对话、语音消息、图片消息、消息历史 | P0 | ✅ |
| **AI角色** | 角色浏览、角色详情、自定义角色、角色分类 | P0 | ✅ |
| **好感度系统** | 6级好感度、进度条、等级提升动画 | P0 | ✅ |
| **礼物系统** | 15种礼物、送礼面板、礼物排行榜 | P1 | ✅ |
| **剧情脚本** | 分支剧情、脚本播放器、可视化编辑器 | P1 | ✅ |
| **通讯录** | 添加/移除角色、置顶、备注名 | P1 | ✅ |
| **朋友圈** | 发布动态、点赞评论、AI自动互动 | P1 | ✅ |
| **用户系统** | 注册登录、VIP等级、每日签到、邀请 | P0 | ✅ |
| **钱包系统** | 金币余额、充值、交易记录 | P0 | ✅ |
| **商城系统** | VIP套餐、金币包、功能包 | P1 | ✅ |
| **TTS语音** | 文字转语音、多音色、角色专属音色 | P2 | ✅ |
| **多语言** | 5种语言（中/繁/英/日/越） | P2 | ✅ |
| **管理后台** | 用户管理、角色管理、数据统计 | P1 | ✅ |

---

## 三、核心功能详述

### 3.1 AI聊天系统

#### 功能描述
用户与AI角色进行实时智能对话，支持多种消息类型和上下文记忆。

#### 功能规格

| 特性 | 规格 |
|------|------|
| 消息类型 | 文字、语音（VIP）、图片（VIP） |
| 上下文长度 | 最近20条消息 |
| AI响应时间 | < 3秒 |
| 消息存储 | 永久保存，支持历史查看 |
| AI记忆 | 记住用户偏好和重要信息 |

#### 用户权限

| 用户类型 | 文字消息 | 语音消息 | 图片消息 |
|----------|----------|----------|----------|
| 普通用户 | 50条/天 | ❌ | ❌ |
| VIP | 200条/天 | ✅ | ✅ |
| SVIP | 无限 | ✅ | ✅ |

---

### 3.2 AI角色系统

#### 角色分类

| 类别 | 数量 | 说明 |
|------|------|------|
| 系统内置 | 3个 | 小微、智博、暖心 - 基础助手角色 |
| RPG仙侠 | 3个 | 云墨仙子、凌霄子、苏婉儿 |
| RPG都市 | 3个 | 陆景深、顾言深、林诗语 |
| RPG科幻 | 2个 | 泽洛·7号、星璃 |
| RPG星际 | 3个 | 雷克斯·诺瓦、艾琳·星芒、艾拉·星辰 |
| RPG修真 | 2个 | 墨渊、白浅 |
| RPG乙游 | 4个 | 陆沉、季时年、沈夜、顾北辰 |
| 陶伴类 | 10个 | 情绪发泄类角色（前任、上司、父母等） |

**角色总计：30个**

#### 角色属性

```yaml
角色基础属性:
  - 名称: String
  - 头像: ImageURL
  - 性格: Enum[高冷/温柔/活泼/霸道/御姐]
  - 性别: Enum[男/女]
  - 简介: Text
  - 系统提示词: Text

RPG专属属性:
  - 子分类: Enum[仙侠/都市/科幻/星际/修真/乙游]
  - 背景故事: Text
  - 剧情脚本: Script[]
  - TTS音色ID: String

权限配置:
  - 是否NSFW: Boolean
  - 是否支持语音: Boolean
  - 是否支持图片: Boolean
```

---

### 3.3 好感度系统

#### 等级配置

| 等级 | 名称 | 好感值范围 | 解锁内容 |
|------|------|-----------|---------|
| 1 | 陌生人 | 0 - 100 | 基础对话 |
| 2 | 熟人 | 100 - 500 | 更多话题 |
| 3 | 朋友 | 500 - 1,500 | 深度交流 |
| 4 | 挚友 | 1,500 - 3,500 | 私密话题 |
| 5 | 挚爱 | 3,500 - 7,000 | NSFW内容（需角色支持） |
| 6 | 灵魂伴侣 | 7,000+ | 全部内容解锁 |

#### 好感度获取

| 行为 | 好感度增加 |
|------|-----------|
| 每次对话 | +1 ~ +3 |
| 送日常礼物 | +1 ~ +5 |
| 送浪漫礼物 | +5 ~ +20 |
| 送奢华礼物 | +20 ~ +50 |
| 送珍贵礼物 | +50 ~ +100 |
| 送传奇礼物 | +100 ~ +500 |
| 完成剧情脚本 | +20 ~ +50 |

#### 视觉效果

- 渐变色进度条（粉紫渐变）
- 闪光效果和平滑过渡动画
- 等级提升时全屏庆祝动画
- 粒子效果、星星装饰、光芒脉冲
- 心跳动画
- 6级等级指示器

---

### 3.4 礼物系统

#### 礼物配置

| 类别 | 礼物名称 | 价格（金币） | 好感度增加 |
|------|----------|-------------|-----------|
| 日常 | 咖啡、花束、小蛋糕 | 10 - 50 | +1 ~ +5 |
| 浪漫 | 玫瑰、巧克力、香水 | 50 - 200 | +5 ~ +20 |
| 奢华 | 项链、手表、包包 | 200 - 500 | +20 ~ +50 |
| 珍贵 | 钻戒、跑车模型、别墅钥匙 | 500 - 1,000 | +50 ~ +100 |
| 传奇 | 星星、月亮、城堡 | 1,000 - 5,000 | +100 ~ +500 |

#### 礼物面板功能

- 分类浏览礼物
- 显示价格和好感度增加值
- 送礼确认对话框
- 余额不足提示和快捷充值入口
- 送礼动画效果

---

### 3.5 剧情脚本系统

#### 功能说明

RPG角色支持预设剧情脚本，用户通过选择不同选项影响剧情走向。

#### 脚本结构

```yaml
脚本节点:
  - id: String
  - 类型: Enum[对话/选项/结局]
  - AI对话内容: Text
  - 选项列表:
      - 选项文字: String
      - 下一节点ID: String
      - 好感度变化: Number
  - 结局类型: Enum[好结局/普通结局/坏结局]
```

#### 已创建脚本

| 角色 | 脚本名称 | 状态 |
|------|---------|------|
| 云墨仙子 | 初入仙境 | ✅ 已完成 |
| 陆景深 | 都市邂逅 | ✅ 已完成 |
| 艾拉·星辰 | 星际冒险 | ✅ 已完成 |

---

### 3.6 用户系统

#### 注册登录

| 方式 | 说明 |
|------|------|
| 邮箱注册 | 邮箱 + 密码 + 验证码 |
| 手机注册 | 手机号 + 短信验证码 |
| OAuth登录 | Manus OAuth |

#### VIP等级

| 等级 | 权益 |
|------|------|
| 普通用户 | 50条消息/天，基础功能 |
| VIP | 200条消息/天，语音消息，图片消息 |
| SVIP | 无限消息，全部功能，优先客服 |

#### 每日签到

| 连续签到天数 | 奖励 |
|-------------|------|
| 1天 | 10积分 + 5金币 |
| 3天 | 30积分 + 15金币 |
| 7天 | 100积分 + 50金币 |
| 30天 | 500积分 + 200金币 |

---

### 3.7 多语言支持

| 语言 | 代码 | 界面 | 角色 |
|------|------|------|------|
| 简体中文 | zh-CN | ✅ | ✅ |
| 繁体中文 | zh-TW | ✅ | ✅ |
| 英语 | en | ✅ | ✅ |
| 日语 | ja | ✅ | ✅ |
| 越南语 | vi | ✅ | ✅ |

---

## 四、技术架构

### 4.1 技术栈

| 层级 | 技术选型 |
|------|---------|
| **Web前端** | React 19 + TypeScript + Tailwind CSS 4 + shadcn/ui |
| **移动端** | Flutter (跨平台) + Swift (iOS原生) |
| **后端** | Express 4 + tRPC 11 + Node.js 18+ |
| **数据库** | MySQL 8 / TiDB |
| **文件存储** | S3兼容对象存储 |
| **认证** | JWT + Manus OAuth |
| **管理后台** | PHP + Bootstrap |

### 4.2 第三方服务

| 服务 | 用途 |
|------|------|
| OpenAI API | LLM对话生成 |
| Claude API | LLM对话生成（备选） |
| Grok API | LLM对话生成（备选） |
| CosyVoice | TTS语音合成 |
| Stripe | 国际支付（可选） |

### 4.3 数据库设计

**核心数据表（55张）**

| 表名 | 说明 |
|------|------|
| users | 用户基础信息 |
| aiCharacters | AI角色配置 |
| chatSessions | 聊天会话 |
| chatMessages | 聊天消息 |
| userCharacterAffinity | 用户-角色好感度 |
| gifts | 礼物配置 |
| giftRecords | 礼物赠送记录 |
| userWallets | 用户钱包 |
| moments | 朋友圈动态 |
| scripts | 剧情脚本 |
| ... | 更多表 |

---

## 五、界面设计

### 5.1 设计规范

| 维度 | 规范 |
|------|------|
| **主色调** | 粉紫渐变 (#ec4899 → #a855f7) |
| **字体** | PingFang SC (中文) / SF Pro (英文) |
| **圆角** | 8px (按钮) / 12px (卡片) / 16px (模态框) |
| **间距** | 基础单位 4px，常用 8/12/16/24px |

### 5.2 核心页面

1. **首页** - 应用介绍、功能展示
2. **聊天列表** - 会话列表、新建对话
3. **聊天详情** - 消息列表、输入框、礼物入口
4. **角色广场** - 角色分类、搜索筛选
5. **角色详情** - 基本信息、好感度、剧情脚本
6. **朋友圈** - 动态列表、发布、互动
7. **钱包** - 余额、充值、交易记录
8. **设置** - 个人信息、语言、主题

---

## 六、API接口

### 6.1 接口统计

| 类别 | 数量 |
|------|------|
| 认证相关 | 4个 |
| 角色相关 | 5个 |
| 聊天相关 | 4个 |
| 礼物相关 | 5个 |
| 钱包相关 | 6个 |
| 商城相关 | 3个 |
| 朋友圈相关 | 6个 |
| 排行榜相关 | 3个 |
| TTS相关 | 3个 |
| 管理后台 | 15+个 |
| **总计** | **53+个** |

### 6.2 核心API

```
POST   /api/auth/register        # 用户注册
POST   /api/auth/login           # 用户登录
GET    /api/characters           # 获取角色列表
GET    /api/characters/:id       # 获取角色详情
POST   /api/chat/sessions        # 创建聊天会话
POST   /api/chat/messages        # 发送消息
GET    /api/affinity/:characterId  # 获取好感度
POST   /api/gifts/send           # 发送礼物
GET    /api/wallet               # 获取钱包信息
POST   /api/tts/synthesize       # 语音合成
```

---

## 七、商业模式

### 7.1 收入来源

| 来源 | 说明 |
|------|------|
| **VIP订阅** | 月度/年度VIP订阅 |
| **金币充值** | 购买金币用于送礼 |
| **功能包** | 特殊功能解锁 |

### 7.2 定价策略

| 商品 | 价格 |
|------|------|
| VIP月卡 | ¥30 |
| VIP季卡 | ¥78 |
| VIP年卡 | ¥268 |
| 100金币 | ¥10 |
| 500金币 | ¥45 |
| 1000金币 | ¥88 |

---

## 八、发展路线图

### Phase 1: 基础完善（当前）
- [x] 核心聊天功能
- [x] AI角色系统
- [x] 好感度系统
- [x] 礼物系统
- [x] 用户系统

### Phase 2: 内容扩展（下一阶段）
- [ ] 更多RPG角色（目标50+）
- [ ] 更多剧情脚本（每角色至少3个）
- [ ] 角色专属TTS音色
- [ ] 送礼动画效果

### Phase 3: 体验优化
- [ ] 实时消息推送（WebSocket）
- [ ] 消息通知
- [ ] 暗黑模式优化
- [ ] 数据分析面板

### Phase 4: 社交扩展
- [ ] 用户社区
- [ ] 角色分享市场
- [ ] 多人聊天室

### Phase 5: AI增强
- [ ] AI绘画功能
- [ ] 声音克隆增强
- [ ] 视频通话
- [ ] 情感分析

---

## 九、风险与挑战

| 风险 | 应对措施 |
|------|---------|
| AI响应延迟 | 多API提供商备选，流式响应 |
| 内容安全 | 内容审核机制，NSFW权限控制 |
| 用户留存 | 好感度系统、每日签到、剧情更新 |
| 成本控制 | API调用优化，缓存策略 |

---

## 十、附录

### 10.1 术语表

| 术语 | 说明 |
|------|------|
| RPG角色 | 具有剧情背景的角色，支持分支剧情 |
| 陶伴类角色 | 用于情绪发泄的特殊角色 |
| 好感度 | 用户与角色的亲密程度数值 |
| 剧情脚本 | 预设的分支对话剧情 |
| TTS | Text-to-Speech，文字转语音 |

### 10.2 参考文档

- [API文档](./API_DOCUMENTATION.md)
- [数据库设计](./DATABASE.md)
- [部署指南](./DEPLOYMENT.md)
- [设计规范](./design-specs.md)
- [用户流程](./user-flows.md)

---

**文档版本**: v2.0
**创建日期**: 2026-02-03
**维护团队**: WeLove Product Team
